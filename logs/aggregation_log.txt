[2026-02-14 06:32:20] 
============================================================
[2026-02-14 06:32:20] E-COMMERCE DATA AGGREGATION PIPELINE
[2026-02-14 06:32:20] ============================================================
[2026-02-14 06:32:20] Start time: 2026-02-14 06:32:20
[2026-02-14 06:32:20] ============================================================
[2026-02-14 06:32:20] STARTING DATA LOAD
[2026-02-14 06:32:20] ============================================================
[2026-02-14 06:32:20] 
1. Loading user_table.csv...
[2026-02-14 06:32:20] ✓ Loaded user_table.csv: 102435 rows
[2026-02-14 06:32:20] 
2. Loading session_table.csv...
[2026-02-14 06:32:21] ✓ Loaded session_table.csv: 146000 rows
[2026-02-14 06:32:21] 
3. Loading order_table.csv...
[2026-02-14 06:32:21] ✓ Loaded order_table.csv: 11206 rows
[2026-02-14 06:32:21] 
4. Loading order_line_item_table.csv...
[2026-02-14 06:32:21] ✓ Loaded order_line_item_table.csv: 22406 rows
[2026-02-14 06:32:21] 
5. Loading add_to_cart_table.csv...
[2026-02-14 06:32:21] ✓ Loaded add_to_cart_table.csv: 25133 rows
[2026-02-14 06:32:21] 
6. Loading pageview_table.csv...
[2026-02-14 06:32:22] ✓ Loaded pageview_table.csv: 354456 rows
[2026-02-14 06:32:23] 
7. Loading scroll_table.csv...
[2026-02-14 06:32:24] ✓ Loaded scroll_table.csv: 292106 rows
[2026-02-14 06:32:24] 
8. Loading click_table.csv...
[2026-02-14 06:32:24] ✓ Loaded click_table.csv: 204752 rows
[2026-02-14 06:32:24] 
============================================================
[2026-02-14 06:32:24] DATA LOAD COMPLETE
[2026-02-14 06:32:24] ============================================================
[2026-02-14 06:32:24] 
============================================================
[2026-02-14 06:32:24] CREATING: daily_business_metrics
[2026-02-14 06:32:24] ============================================================
[2026-02-14 06:32:24]   Calculating total revenue...
[2026-02-14 06:32:24]   Calculating total orders...
[2026-02-14 06:32:24]   Calculating total sessions...
[2026-02-14 06:32:24]   Calculating total users...
[2026-02-14 06:32:24]   Calculating conversion rate...
[2026-02-14 06:32:24]   Calculating average order value...
[2026-02-14 06:32:24]   Calculating new vs repeat customers...
[2026-02-14 06:32:25]   Combining metrics...
[2026-02-14 06:32:25] ✓ Created 365 daily records
[2026-02-14 06:32:25]   Date range: 2025-01-01 to 2025-12-31
[2026-02-14 06:32:25]   Total revenue in dataset: $5,553,264.00
[2026-02-14 06:32:25] 
============================================================
[2026-02-14 06:32:25] CREATING: session_attribution
[2026-02-14 06:32:25] ============================================================
[2026-02-14 06:32:25]   Merging sessions with orders...
[2026-02-14 06:32:25]   Calculating conversion flags...
[2026-02-14 06:32:25]   Selecting columns...
[2026-02-14 06:32:25] ✓ Created 146000 session records
[2026-02-14 06:32:25]   Converted sessions: 11206
[2026-02-14 06:32:25]   Conversion rate: 7.68%
[2026-02-14 06:32:25]   Total attributed revenue: $5,553,264.00
[2026-02-14 06:32:25] 
============================================================
[2026-02-14 06:32:25] CREATING: session_funnel
[2026-02-14 06:32:25] ============================================================
[2026-02-14 06:32:25]   Building funnel base...
[2026-02-14 06:32:25]   Checking product views...
[2026-02-14 06:32:25]   Checking cart additions...
[2026-02-14 06:32:25]   Checking orders...
[2026-02-14 06:32:25]   Calculating time metrics...
[2026-02-14 06:32:25] ✓ Created 146000 session funnel records
[2026-02-14 06:32:25]   Funnel breakdown:
[2026-02-14 06:32:25]     Sessions: 146000 (100.0%)
[2026-02-14 06:32:25]     Product Views: 0 (0.0%)
[2026-02-14 06:32:25]     Cart Adds: 25133 (17.2%)
[2026-02-14 06:32:25]     Orders: 11206 (7.7%)
[2026-02-14 06:32:25] 
============================================================
[2026-02-14 06:32:25] CREATING: product_performance_daily
[2026-02-14 06:32:25] ============================================================
[2026-02-14 06:32:25]   Aggregating order data...
[2026-02-14 06:32:25]   Adding cart data...
[2026-02-14 06:32:25] ✓ Created 1460 product-day records
[2026-02-14 06:32:25]   Unique products: 4
[2026-02-14 06:32:25]   Date range: 2025-01-01 to 2025-12-31
[2026-02-14 06:32:25]   Total revenue: $5,553,264.00
[2026-02-14 06:32:25]   Top 5 products by revenue:
[2026-02-14 06:32:25]     Video Doorbell Pro 2: $2,115,415.38
[2026-02-14 06:32:25]     Ring Alarm 8-piece: $2,098,416.06
[2026-02-14 06:32:25]     Stick Up Cam Battery: $837,316.26
[2026-02-14 06:32:25]     Indoor Cam (2nd Gen): $502,116.30
[2026-02-14 06:32:25] 
============================================================
[2026-02-14 06:32:25] CREATING: user_lifetime_metrics
[2026-02-14 06:32:25] ============================================================
[2026-02-14 06:32:25]   Calculating user metrics...
[2026-02-14 06:32:25]   Calculating recency...
[2026-02-14 06:32:25]   Calculating RFM scores...
[2026-02-14 06:32:25]   Assigning customer segments...
[2026-02-14 06:32:25] ✓ Created 10853 user records
[2026-02-14 06:32:25]   Total users: 10853
[2026-02-14 06:32:25]   Total revenue (all users): $5,553,264.00
[2026-02-14 06:32:25]   Average LTV per user: $511.68
[2026-02-14 06:32:25]   Customer segment breakdown:
[2026-02-14 06:32:25]     Needs Attention: 5523 (50.9%)
[2026-02-14 06:32:25]     New Customer: 3976 (36.6%)
[2026-02-14 06:32:25]     Lost: 1232 (11.4%)
[2026-02-14 06:32:25]     Potential Loyalist: 116 (1.1%)
[2026-02-14 06:32:25]     At Risk: 6 (0.1%)
[2026-02-14 06:32:25] 
============================================================
[2026-02-14 06:32:25] CREATING: page_engagement_metrics
[2026-02-14 06:32:25] ============================================================
[2026-02-14 06:32:25]   Aggregating pageview data...
[2026-02-14 06:32:25]   Adding scroll data...
[2026-02-14 06:32:26]   Adding click data...
[2026-02-14 06:32:26] ✓ Created 2920 page-day records
[2026-02-14 06:32:26]   Unique pages: 8
[2026-02-14 06:32:26]   Total pageviews: 354,456
[2026-02-14 06:32:26]   Top 5 pages by pageviews:
[2026-02-14 06:32:26]     /category/security-cameras: 52,353 views
[2026-02-14 06:32:26]     /checkout/thankyou: 52,179 views
[2026-02-14 06:32:26]     /checkout/payment: 52,141 views
[2026-02-14 06:32:26]     /cart: 51,783 views
[2026-02-14 06:32:26]     /products/ring-alarm-8-piece: 36,779 views
[2026-02-14 06:32:26] 
============================================================
[2026-02-14 06:32:26] CREATING: coupon_performance
[2026-02-14 06:32:26] ============================================================
[2026-02-14 06:32:26]   Aggregating coupon data...
[2026-02-14 06:32:26] ✓ Created 1094 coupon-day records
[2026-02-14 06:32:26]   Unique coupons: 3
[2026-02-14 06:32:26]   Total discount given: $112,570.00
[2026-02-14 06:32:26]   Total revenue with coupons: $5,553,264.00
[2026-02-14 06:32:26]   Top 5 coupons by usage:
[2026-02-14 06:32:26]     HOLIDAY10: 3788 uses, $38,460.00 discount
[2026-02-14 06:32:26]     RING20: 3767 uses, $37,200.00 discount
[2026-02-14 06:32:26]     NO_COUPON: 3651 uses, $36,910.00 discount
[2026-02-14 06:32:26] 
============================================================
[2026-02-14 06:32:26] SAVING AGGREGATED TABLES
[2026-02-14 06:32:26] ============================================================
[2026-02-14 06:32:26] ✓ Saved: daily_business_metrics.csv (365 rows)
[2026-02-14 06:32:26] ✓ Saved: session_attribution.csv (146000 rows)
[2026-02-14 06:32:27] ✓ Saved: session_funnel.csv (146000 rows)
[2026-02-14 06:32:27] ✓ Saved: product_performance_daily.csv (1460 rows)
[2026-02-14 06:32:27] ✓ Saved: user_lifetime_metrics.csv (10853 rows)
[2026-02-14 06:32:27] ✓ Saved: page_engagement_metrics.csv (2920 rows)
[2026-02-14 06:32:27] ✓ Saved: coupon_performance.csv (1094 rows)
[2026-02-14 06:32:27] 
============================================================
[2026-02-14 06:32:27] PIPELINE COMPLETE
[2026-02-14 06:32:27] ============================================================
[2026-02-14 06:32:27] End time: 2026-02-14 06:32:27
[2026-02-14 06:32:27] Duration: 7.06 seconds
[2026-02-14 06:32:27] 
Aggregated files saved to: aggregated_data/
[2026-02-14 06:32:27] ============================================================
[2026-02-14 10:37:49] 
============================================================
[2026-02-14 10:37:49] E-COMMERCE DATA AGGREGATION PIPELINE
[2026-02-14 10:37:49] ============================================================
[2026-02-14 10:37:49] Start time: 2026-02-14 10:37:49
[2026-02-14 10:37:49] ============================================================
[2026-02-14 10:37:49] STARTING DATA LOAD
[2026-02-14 10:37:49] ============================================================
[2026-02-14 10:37:49] 
1. Loading user_table.csv...
[2026-02-14 10:37:49] ✓ Loaded user_table.csv: 102435 rows
[2026-02-14 10:37:49] 
2. Loading session_table.csv...
[2026-02-14 10:37:49] ✓ Loaded session_table.csv: 146000 rows
[2026-02-14 10:37:49] 
3. Loading order_table.csv...
[2026-02-14 10:37:49] ✓ Loaded order_table.csv: 11206 rows
[2026-02-14 10:37:49] 
4. Loading order_line_item_table.csv...
[2026-02-14 10:37:49] ✓ Loaded order_line_item_table.csv: 22406 rows
[2026-02-14 10:37:49] 
5. Loading add_to_cart_table.csv...
[2026-02-14 10:37:50] ✓ Loaded add_to_cart_table.csv: 25133 rows
[2026-02-14 10:37:50] 
6. Loading pageview_table.csv...
[2026-02-14 10:37:50] ✓ Loaded pageview_table.csv: 354456 rows
[2026-02-14 10:37:50] 
7. Loading scroll_table.csv...
[2026-02-14 10:37:51] ✓ Loaded scroll_table.csv: 292106 rows
[2026-02-14 10:37:51] 
8. Loading click_table.csv...
[2026-02-14 10:37:52] ✓ Loaded click_table.csv: 204752 rows
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] DATA LOAD COMPLETE
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] CREATING: daily_business_metrics
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:52]   Calculating total revenue...
[2026-02-14 10:37:52]   Calculating total orders...
[2026-02-14 10:37:52]   Calculating total sessions...
[2026-02-14 10:37:52]   Calculating total users...
[2026-02-14 10:37:52]   Calculating conversion rate...
[2026-02-14 10:37:52]   Calculating average order value...
[2026-02-14 10:37:52]   Calculating new vs repeat customers...
[2026-02-14 10:37:52]   Combining metrics...
[2026-02-14 10:37:52] ✓ Created 365 daily records
[2026-02-14 10:37:52]   Date range: 2025-01-01 to 2025-12-31
[2026-02-14 10:37:52]   Total revenue in dataset: $5,553,264.00
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] CREATING: session_attribution
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:52]   Merging sessions with orders...
[2026-02-14 10:37:52]   Calculating conversion flags...
[2026-02-14 10:37:52]   Selecting columns...
[2026-02-14 10:37:52] ✓ Created 146000 session records
[2026-02-14 10:37:52]   Converted sessions: 11206
[2026-02-14 10:37:52]   Conversion rate: 7.68%
[2026-02-14 10:37:52]   Total attributed revenue: $5,553,264.00
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] CREATING: session_funnel
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:52]   Building funnel base...
[2026-02-14 10:37:52]   Checking product views...
[2026-02-14 10:37:52]   Checking cart additions...
[2026-02-14 10:37:52]   Checking orders...
[2026-02-14 10:37:52]   Calculating time metrics...
[2026-02-14 10:37:52] ✓ Created 146000 session funnel records
[2026-02-14 10:37:52]   Funnel breakdown:
[2026-02-14 10:37:52]     Sessions: 146000 (100.0%)
[2026-02-14 10:37:52]     Product Views: 0 (0.0%)
[2026-02-14 10:37:52]     Cart Adds: 25133 (17.2%)
[2026-02-14 10:37:52]     Orders: 11206 (7.7%)
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] CREATING: product_performance_daily
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:52]   Aggregating order data...
[2026-02-14 10:37:52]   Adding cart data...
[2026-02-14 10:37:52] ✓ Created 1460 product-day records
[2026-02-14 10:37:52]   Unique products: 4
[2026-02-14 10:37:52]   Date range: 2025-01-01 to 2025-12-31
[2026-02-14 10:37:52]   Total revenue: $5,553,264.00
[2026-02-14 10:37:52]   Top 5 products by revenue:
[2026-02-14 10:37:52]     Video Doorbell Pro 2: $2,115,415.38
[2026-02-14 10:37:52]     Ring Alarm 8-piece: $2,098,416.06
[2026-02-14 10:37:52]     Stick Up Cam Battery: $837,316.26
[2026-02-14 10:37:52]     Indoor Cam (2nd Gen): $502,116.30
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] CREATING: user_lifetime_metrics
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:52]   Calculating user metrics...
[2026-02-14 10:37:52]   Calculating recency...
[2026-02-14 10:37:52]   Calculating RFM scores...
[2026-02-14 10:37:52]   Assigning customer segments...
[2026-02-14 10:37:52] ✓ Created 10853 user records
[2026-02-14 10:37:52]   Total users: 10853
[2026-02-14 10:37:52]   Total revenue (all users): $5,553,264.00
[2026-02-14 10:37:52]   Average LTV per user: $511.68
[2026-02-14 10:37:52]   Customer segment breakdown:
[2026-02-14 10:37:52]     Needs Attention: 5517 (50.8%)
[2026-02-14 10:37:52]     New Customer: 4004 (36.9%)
[2026-02-14 10:37:52]     Lost: 1210 (11.1%)
[2026-02-14 10:37:52]     Potential Loyalist: 116 (1.1%)
[2026-02-14 10:37:52]     At Risk: 6 (0.1%)
[2026-02-14 10:37:52] 
============================================================
[2026-02-14 10:37:52] CREATING: page_engagement_metrics
[2026-02-14 10:37:52] ============================================================
[2026-02-14 10:37:53]   Aggregating pageview data...
[2026-02-14 10:37:53]   Adding scroll data...
[2026-02-14 10:37:53]   Adding click data...
[2026-02-14 10:37:53] ✓ Created 2920 page-day records
[2026-02-14 10:37:53]   Unique pages: 8
[2026-02-14 10:37:53]   Total pageviews: 354,456
[2026-02-14 10:37:53]   Top 5 pages by pageviews:
[2026-02-14 10:37:53]     /category/security-cameras: 52,353 views
[2026-02-14 10:37:53]     /checkout/thankyou: 52,179 views
[2026-02-14 10:37:53]     /checkout/payment: 52,141 views
[2026-02-14 10:37:53]     /cart: 51,783 views
[2026-02-14 10:37:53]     /products/ring-alarm-8-piece: 36,779 views
[2026-02-14 10:37:53] 
============================================================
[2026-02-14 10:37:53] CREATING: coupon_performance
[2026-02-14 10:37:53] ============================================================
[2026-02-14 10:37:53]   Aggregating coupon data...
[2026-02-14 10:37:53] ✓ Created 1094 coupon-day records
[2026-02-14 10:37:53]   Unique coupons: 3
[2026-02-14 10:37:53]   Total discount given: $112,570.00
[2026-02-14 10:37:53]   Total revenue with coupons: $5,553,264.00
[2026-02-14 10:37:53]   Top 5 coupons by usage:
[2026-02-14 10:37:53]     HOLIDAY10: 3788 uses, $38,460.00 discount
[2026-02-14 10:37:53]     RING20: 3767 uses, $37,200.00 discount
[2026-02-14 10:37:53]     NO_COUPON: 3651 uses, $36,910.00 discount
[2026-02-14 10:37:53] 
============================================================
[2026-02-14 10:37:53] SAVING AGGREGATED TABLES
[2026-02-14 10:37:53] ============================================================
[2026-02-14 10:37:53] ✓ Saved: daily_business_metrics.csv (365 rows)
[2026-02-14 10:37:54] ✓ Saved: session_attribution.csv (146000 rows)
[2026-02-14 10:37:55] ✓ Saved: session_funnel.csv (146000 rows)
[2026-02-14 10:37:55] ✓ Saved: product_performance_daily.csv (1460 rows)
[2026-02-14 10:37:55] ✓ Saved: user_lifetime_metrics.csv (10853 rows)
[2026-02-14 10:37:55] ✓ Saved: page_engagement_metrics.csv (2920 rows)
[2026-02-14 10:37:55] ✓ Saved: coupon_performance.csv (1094 rows)
[2026-02-14 10:37:55] 
============================================================
[2026-02-14 10:37:55] PIPELINE COMPLETE
[2026-02-14 10:37:55] ============================================================
[2026-02-14 10:37:55] End time: 2026-02-14 10:37:55
[2026-02-14 10:37:55] Duration: 6.39 seconds
[2026-02-14 10:37:55] 
Aggregated files saved to: aggregated_data/
[2026-02-14 10:37:55] ============================================================
[2026-02-17 13:05:30] 
============================================================
[2026-02-17 13:05:30] E-COMMERCE DATA AGGREGATION PIPELINE
[2026-02-17 13:05:30] ============================================================
[2026-02-17 13:05:30] Start time: 2026-02-17 13:05:30
[2026-02-17 13:05:30] ============================================================
[2026-02-17 13:05:30] STARTING DATA LOAD
[2026-02-17 13:05:30] ============================================================
[2026-02-17 13:05:30] 
1. Loading user_table.csv...
[2026-02-17 13:05:30] ✓ Loaded user_table.csv: 102435 rows
[2026-02-17 13:05:30] 
2. Loading session_table.csv...
[2026-02-17 13:05:33] ✓ Loaded session_table.csv: 130980 rows
[2026-02-17 13:05:33] 
3. Loading order_table.csv...
[2026-02-17 13:05:34] ✓ Loaded order_table.csv: 11206 rows
[2026-02-17 13:05:34] 
4. Loading order_line_item_table.csv...
[2026-02-17 13:05:34] ✓ Loaded order_line_item_table.csv: 22406 rows
[2026-02-17 13:05:34] 
5. Loading add_to_cart_table.csv...
[2026-02-17 13:05:34] ✓ Loaded add_to_cart_table.csv: 25133 rows
[2026-02-17 13:05:34] 
6. Loading pageview_table.csv...
[2026-02-17 13:05:39] ✓ Loaded pageview_table.csv: 354456 rows
[2026-02-17 13:05:39] 
7. Loading scroll_table.csv...
[2026-02-17 13:05:43] ✓ Loaded scroll_table.csv: 292106 rows
[2026-02-17 13:05:43] 
8. Loading click_table.csv...
[2026-02-17 13:05:46] ✓ Loaded click_table.csv: 204752 rows
[2026-02-17 13:05:46] 
============================================================
[2026-02-17 13:05:46] DATA LOAD COMPLETE
[2026-02-17 13:05:46] ============================================================
[2026-02-17 13:05:46] 
============================================================
[2026-02-17 13:05:46] CREATING: daily_business_metrics
[2026-02-17 13:05:46] ============================================================
[2026-02-17 13:05:46]   Calculating total revenue...
[2026-02-17 13:05:46]   Calculating total orders...
[2026-02-17 13:05:46]   Calculating total sessions...
[2026-02-17 13:05:46]   Calculating total users...
[2026-02-17 13:05:46]   Calculating conversion rate...
[2026-02-17 13:05:46]   Calculating average order value...
[2026-02-17 13:05:46]   Calculating new vs repeat customers...
[2026-02-17 13:05:46]   Combining metrics...
[2026-02-17 13:05:46] ✓ Created 340 daily records
[2026-02-17 13:05:46]   Date range: 2025-01-01 to 2025-12-12
[2026-02-17 13:05:46]   Total revenue in dataset: $2,193,168.12
[2026-02-17 13:05:46] 
============================================================
[2026-02-17 13:05:46] CREATING: session_attribution
[2026-02-17 13:05:46] ============================================================
[2026-02-17 13:05:46]   Merging sessions with orders...
[2026-02-17 13:05:46]   Calculating conversion flags...
[2026-02-17 13:05:46]   Selecting columns...
[2026-02-17 13:05:46] ✓ Created 130980 session records
[2026-02-17 13:05:46]   Converted sessions: 10050
[2026-02-17 13:05:46]   Conversion rate: 7.67%
[2026-02-17 13:05:46]   Total attributed revenue: $4,990,378.16
[2026-02-17 13:05:46] 
============================================================
[2026-02-17 13:05:46] CREATING: session_funnel
[2026-02-17 13:05:46] ============================================================
[2026-02-17 13:05:46]   Building funnel base...
[2026-02-17 13:05:46]   Checking product views...
[2026-02-17 13:05:46]   Checking cart additions...
[2026-02-17 13:05:46]   Checking orders...
[2026-02-17 13:05:46]   Calculating time metrics...
[2026-02-17 13:05:46] ✓ Created 130980 session funnel records
[2026-02-17 13:05:46]   Funnel breakdown:
[2026-02-17 13:05:46]     Sessions: 130980 (100.0%)
[2026-02-17 13:05:46]     Product Views: 0 (0.0%)
[2026-02-17 13:05:46]     Cart Adds: 22595 (17.3%)
[2026-02-17 13:05:46]     Orders: 10050 (7.7%)
[2026-02-17 13:05:46] 
============================================================
[2026-02-17 13:05:46] CREATING: product_performance_daily
[2026-02-17 13:05:46] ============================================================
[2026-02-17 13:05:46]   Aggregating order data...
[2026-02-17 13:05:46]   Adding cart data...
[2026-02-17 13:05:46] ✓ Created 576 product-day records
[2026-02-17 13:05:46]   Unique products: 4
[2026-02-17 13:05:46]   Date range: 2025-01-01 to 2025-12-12
[2026-02-17 13:05:46]   Total revenue: $3,661,620.28
[2026-02-17 13:05:46]   Top 5 products by revenue:
[2026-02-17 13:05:46]     Video Doorbell Pro 2: $1,418,443.26
[2026-02-17 13:05:46]     Ring Alarm 8-piece: $1,373,445.06
[2026-02-17 13:05:46]     Stick Up Cam Battery: $553,944.60
[2026-02-17 13:05:46]     Indoor Cam (2nd Gen): $315,787.36
[2026-02-17 13:05:46] 
============================================================
[2026-02-17 13:05:46] CREATING: user_lifetime_metrics
[2026-02-17 13:05:46] ============================================================
[2026-02-17 13:05:46]   Calculating user metrics...
[2026-02-17 13:05:46]   Calculating recency...
[2026-02-17 13:05:46]   Calculating RFM scores...
[2026-02-17 13:08:18] 
============================================================
[2026-02-17 13:08:18] E-COMMERCE DATA AGGREGATION PIPELINE
[2026-02-17 13:08:18] ============================================================
[2026-02-17 13:08:18] Start time: 2026-02-17 13:08:18
[2026-02-17 13:08:18] ============================================================
[2026-02-17 13:08:18] STARTING DATA LOAD
[2026-02-17 13:08:18] ============================================================
[2026-02-17 13:08:18] 
1. Loading user_table.csv...
[2026-02-17 13:08:18] ✓ Loaded user_table.csv: 102435 rows
[2026-02-17 13:08:18] 
2. Loading session_table.csv...
[2026-02-17 13:08:19] ✓ Loaded session_table.csv: 130980 rows
[2026-02-17 13:08:19] 
3. Loading order_table.csv...
[2026-02-17 13:08:19] ✓ Loaded order_table.csv: 11206 rows
[2026-02-17 13:08:19] 
4. Loading order_line_item_table.csv...
[2026-02-17 13:08:19] ✓ Loaded order_line_item_table.csv: 22406 rows
[2026-02-17 13:08:19] 
5. Loading add_to_cart_table.csv...
[2026-02-17 13:08:19] ✓ Loaded add_to_cart_table.csv: 25133 rows
[2026-02-17 13:08:19] 
6. Loading pageview_table.csv...
[2026-02-17 13:08:21] ✓ Loaded pageview_table.csv: 354456 rows
[2026-02-17 13:08:21] 
7. Loading scroll_table.csv...
[2026-02-17 13:08:22] ✓ Loaded scroll_table.csv: 292106 rows
[2026-02-17 13:08:22] 
8. Loading click_table.csv...
[2026-02-17 13:08:23] ✓ Loaded click_table.csv: 204752 rows
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] DATA LOAD COMPLETE
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] CREATING: daily_business_metrics
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23]   Calculating total revenue...
[2026-02-17 13:08:23]   Calculating total orders...
[2026-02-17 13:08:23]   Calculating total sessions...
[2026-02-17 13:08:23]   Calculating total users...
[2026-02-17 13:08:23]   Calculating conversion rate...
[2026-02-17 13:08:23]   Calculating average order value...
[2026-02-17 13:08:23]   Calculating new vs repeat customers...
[2026-02-17 13:08:23]   Combining metrics...
[2026-02-17 13:08:23] ✓ Created 340 daily records
[2026-02-17 13:08:23]   Date range: 2025-01-01 to 2025-12-12
[2026-02-17 13:08:23]   Total revenue in dataset: $2,193,168.12
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] CREATING: session_attribution
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23]   Merging sessions with orders...
[2026-02-17 13:08:23]   Calculating conversion flags...
[2026-02-17 13:08:23]   Selecting columns...
[2026-02-17 13:08:23] ✓ Created 130980 session records
[2026-02-17 13:08:23]   Converted sessions: 10050
[2026-02-17 13:08:23]   Conversion rate: 7.67%
[2026-02-17 13:08:23]   Total attributed revenue: $4,990,378.16
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] CREATING: session_funnel
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23]   Building funnel base...
[2026-02-17 13:08:23]   Checking product views...
[2026-02-17 13:08:23]   Checking cart additions...
[2026-02-17 13:08:23]   Checking orders...
[2026-02-17 13:08:23]   Calculating time metrics...
[2026-02-17 13:08:23] ✓ Created 130980 session funnel records
[2026-02-17 13:08:23]   Funnel breakdown:
[2026-02-17 13:08:23]     Sessions: 130980 (100.0%)
[2026-02-17 13:08:23]     Product Views: 0 (0.0%)
[2026-02-17 13:08:23]     Cart Adds: 22595 (17.3%)
[2026-02-17 13:08:23]     Orders: 10050 (7.7%)
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] CREATING: product_performance_daily
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23]   Aggregating order data...
[2026-02-17 13:08:23]   Adding cart data...
[2026-02-17 13:08:23] ✓ Created 576 product-day records
[2026-02-17 13:08:23]   Unique products: 4
[2026-02-17 13:08:23]   Date range: 2025-01-01 to 2025-12-12
[2026-02-17 13:08:23]   Total revenue: $3,661,620.28
[2026-02-17 13:08:23]   Top 5 products by revenue:
[2026-02-17 13:08:23]     Video Doorbell Pro 2: $1,418,443.26
[2026-02-17 13:08:23]     Ring Alarm 8-piece: $1,373,445.06
[2026-02-17 13:08:23]     Stick Up Cam Battery: $553,944.60
[2026-02-17 13:08:23]     Indoor Cam (2nd Gen): $315,787.36
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] CREATING: user_lifetime_metrics
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23]   Calculating user metrics...
[2026-02-17 13:08:23]   Calculating recency...
[2026-02-17 13:08:23]   Calculating RFM scores...
[2026-02-17 13:08:23]   Assigning customer segments...
[2026-02-17 13:08:23] ✓ Created 10853 user records
[2026-02-17 13:08:23]   Total users: 10853
[2026-02-17 13:08:23]   Total revenue (all users): $5,553,264.00
[2026-02-17 13:08:23]   Average LTV per user: $511.68
[2026-02-17 13:08:23]   Customer segment breakdown:
[2026-02-17 13:08:23]     Lost: 7247 (66.8%)
[2026-02-17 13:08:23]     Needs Attention: 2166 (20.0%)
[2026-02-17 13:08:23]     New Customer: 1355 (12.5%)
[2026-02-17 13:08:23]     Potential Loyalist: 78 (0.7%)
[2026-02-17 13:08:23]     At Risk: 7 (0.1%)
[2026-02-17 13:08:23] 
============================================================
[2026-02-17 13:08:23] CREATING: page_engagement_metrics
[2026-02-17 13:08:23] ============================================================
[2026-02-17 13:08:23]   Aggregating pageview data...
[2026-02-17 13:08:24]   Adding scroll data...
[2026-02-17 13:08:24]   Adding click data...
[2026-02-17 13:08:24] ✓ Created 2920 page-day records
[2026-02-17 13:08:24]   Unique pages: 8
[2026-02-17 13:08:24]   Total pageviews: 354,456
[2026-02-17 13:08:24]   Top 5 pages by pageviews:
[2026-02-17 13:08:24]     /category/security-cameras: 52,353 views
[2026-02-17 13:08:24]     /checkout/thankyou: 52,179 views
[2026-02-17 13:08:24]     /checkout/payment: 52,141 views
[2026-02-17 13:08:24]     /cart: 51,783 views
[2026-02-17 13:08:24]     /products/ring-alarm-8-piece: 36,779 views
[2026-02-17 13:08:24] 
============================================================
[2026-02-17 13:08:24] CREATING: coupon_performance
[2026-02-17 13:08:24] ============================================================
[2026-02-17 13:08:24]   Aggregating coupon data...
[2026-02-17 13:08:24] ✓ Created 432 coupon-day records
[2026-02-17 13:08:24]   Unique coupons: 3
[2026-02-17 13:08:24]   Total discount given: $44,720.00
[2026-02-17 13:08:24]   Total revenue with coupons: $2,193,168.12
[2026-02-17 13:08:24]   Top 5 coupons by usage:
[2026-02-17 13:08:24]     RING20: 1501 uses, $30,020.00 discount
[2026-02-17 13:08:24]     HOLIDAY10: 1470 uses, $14,700.00 discount
[2026-02-17 13:08:24]     NO_COUPON: 1448 uses, $0.00 discount
[2026-02-17 13:08:24] 
============================================================
[2026-02-17 13:08:24] SAVING AGGREGATED TABLES
[2026-02-17 13:08:24] ============================================================
[2026-02-17 13:08:24] ✓ Saved: daily_business_metrics.csv (340 rows)
[2026-02-17 13:08:25] ✓ Saved: session_attribution.csv (130980 rows)
[2026-02-17 13:08:25] ✓ Saved: session_funnel.csv (130980 rows)
[2026-02-17 13:08:25] ✓ Saved: product_performance_daily.csv (576 rows)
[2026-02-17 13:08:25] ✓ Saved: user_lifetime_metrics.csv (10853 rows)
[2026-02-17 13:08:25] ✓ Saved: page_engagement_metrics.csv (2920 rows)
[2026-02-17 13:08:25] ✓ Saved: coupon_performance.csv (432 rows)
[2026-02-17 13:08:25] 
============================================================
[2026-02-17 13:08:25] PIPELINE COMPLETE
[2026-02-17 13:08:25] ============================================================
[2026-02-17 13:08:25] End time: 2026-02-17 13:08:25
[2026-02-17 13:08:25] Duration: 6.90 seconds
[2026-02-17 13:08:25] 
Aggregated files saved to: aggregated_data/
[2026-02-17 13:08:25] ============================================================
